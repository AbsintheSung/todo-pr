import{l as r,a,t as i,e as c}from"./swal-BUWR2XwI.js";const l=document.querySelector(".login-form"),u=document.querySelector(".login-email"),m=document.querySelector(".login-password"),d=document.querySelector(".login-btn"),g=document.querySelectorAll(".login-warn"),t=Array.from(g),p=async o=>{try{r("登入中");const e=await a.post("https://todoo.5xcamp.us/users/sign_in",o);e.status===200&&(document.cookie=`TokenCode=${e.headers.authorization}`,sessionStorage.setItem(`nickname${e.headers.authorization}`,e.data.nickname),i("success","登入成功"),window.location.href="../pages/home")}catch(e){console.error(e.response),c(e.response.data.message,"error")}},f={email:{presence:{message:"必填"},email:{message:"須符合Email格式"}},password:{presence:{message:"必填"},length:{minimum:6,message:"密碼長度必須大於6"}}};function s(){t.forEach(o=>{o.textContent=""})}function h(o){for(let e in o)t.forEach(n=>{n.id===e+"warn"&&(n.textContent=o[e].pop().split(" ").slice(1).join(" "))})}d.addEventListener("click",async o=>{o.preventDefault();const e=validate(l,f),n={user:{email:u.value,password:m.value}};s(),e?h(e):await p(n)});s();
